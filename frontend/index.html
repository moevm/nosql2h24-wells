<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карта и список</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <div class="col-md-4 pt-3 overflow-auto">

                <section id="courtyards" class="h-60">
                    <div class="search mb-3 d-flex align-items-center">
                        <input type="text" class="form-control mr-2" placeholder="Поиск по дворам">
                        <a class="btn btn-primary" href="advanced_courtyard_search.html">
                            <span class="material-icons">settings</span>
                        </a>
                    </div>
                    <div class="list-group" id="courtyards-list">
                        
                    </div>
                </section>
                <section id="users" class="h-40">
                    <div class="search my-3 d-flex align-items-center">
                        <input type="text" class="form-control mr-2" placeholder="Поиск по пользователям">
                        <a class="btn btn-primary" href="advanced_user_search.html">
                            <span class="material-icons">settings</span>
                        </a>
                    </div>
                    <div class="list-group" id="users-list">
                        
                    </div>
                </section>
            </div>
            <div class="col-md-8 p-0">
                <div id="map" class="w-100 h-100"></div>
            </div>
        </div>
    </div>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <script src="https://api-maps.yandex.ru/2.0-stable/?apikey=0faafbbe-1718-4c19-b6e2-46f316ed4ba5&load=package.full&lang=ru-RU" type="text/javascript"></script>
    <script src="scripts/templates.js"></script>
    <script>
        ymaps.ready(init);

        function init() {
            // settings
            var myMap = new ymaps.Map ('map', {
                center: [59.9342802, 30.3350986], // lat lon
                zoom: 13
            });
            myMap.controls
                .add('mapTools')       // стандартные кнопки
                .add('typeSelector')   // переключатель типа карты
                .add('zoomControl');   // изменение масштаба
            
            // placemarks
            let courtyard_id = 123;
            let coordinates = [
                [59.933, 30.333],
                [59.933, 30.3350986],
                [59.9342802, 30.3350986],
                [59.9342802, 30.333]
            ];
            let mean_lat = 0;
            let mean_lon = 0;
            for (let i = 0; i < coordinates.length; i++) {
                const latlon = coordinates[i];
                mean_lat += coordinates[i][0];
                mean_lon += coordinates[i][1];
            }
            mean_lat /= coordinates.length;
            mean_lon /= coordinates.length;
            let title = 'Двор-восьмиугольник';
            var myPlacemark = new ymaps.Placemark([mean_lat, mean_lon], { 
                iconContent: title,
                id: courtyard_id
            }, {
                // Опции
                preset: 'twirl#blueStretchyIcon' // иконка растягивается под контент
            });
            myPlacemark.events.add(['click'], function(e) {
                window.location.assign('courtyard.html?id=' + e.get('target').properties._data.id);
            });


            var myPolygon = new ymaps.Polygon([coordinates]);
            myMap.geoObjects.add(myPolygon);
            myMap.geoObjects.add(myPlacemark);

        }
        // https://tokmakov.msk.ru/blog/item/16

        window.onload = () => {
            let username = "ivanovii";
            let last_name = "Иванов";
            let first_name = "Иван";
            let patronymic = "Иванович";
            let visited = 123;

            let card = generateUserCard(username, last_name, first_name, patronymic, visited)
            let list = document.getElementById("users-list");
            for (let index = 0; index < 120; index++) {
                list.innerHTML += card;
            }
            // -----
            let address = "Рылеева, 22";
            let label = "Двор-восьмиугольник";
            let rating = 4.7;

            let cardc = generateCourtyardCard(label, address, rating)
            let listc = document.getElementById("courtyards-list");
            for (let index = 0; index < 120; index++) {
                listc.innerHTML += cardc;
            }
            console.log("aa");
        }
    </script>
</body>
</html>

<!-- 13:54 -->